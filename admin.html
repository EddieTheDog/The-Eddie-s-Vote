<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Eddie's 2025 Admin</title>
<style>
body { font-family: Arial; background:#f7f7f7; padding:20px; }
h1 { text-align:center; }
input, select { margin:5px 0; padding:5px; }
button { padding:10px 20px; margin-top:5px; border:none; background:#007AFF; color:white; border-radius:5px; cursor:pointer; }
button:hover { background:#005BBB; }
</style>
</head>
<body>
<h1>The Eddie's 2025 Admin</h1>

<h2>Add Category</h2>
<input type="text" id="new-category" placeholder="Category name">
<button id="add-category-btn">Add Category</button>

<h2>Add Film</h2>
<select id="category-select"></select>
<input type="text" id="new-film" placeholder="Film name">
<button id="add-film-btn">Add Film</button>

<script type="module">
window.onload = async () => {
  const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm');
  if (!window.supabase) {
    window.supabase = createClient(
      'https://asrydhgpdlpocuapcvuf.supabase.co',
      'sb_publishable_KANIL3DCSWPFVyJjhJ4uYA_38LnWmCu'
    );
  }
  const supabase = window.supabase;

  const categorySelect = document.getElementById('category-select');

  async function loadCategories() {
    const { data, error } = await supabase.from('categories').select('*').order('id');
    if (error) { console.error(error); return; }

    categorySelect.innerHTML = '';
    for (let category of data) {
      const option = document.createElement('option');
      option.value = category.id;
      option.textContent = category.name;
      categorySelect.appendChild(option);
    }
  }

  await loadCategories();

  document.getElementById('add-category-btn')?.addEventListener('click', async () => {
    const name = document.getElementById('new-category').value.trim();
    if (!name) return;
    await supabase.from('categories').insert([{ name, active: true }]);
    document.getElementById('new-category').value = '';
    await loadCategories();
  });

  document.getElementById('add-film-btn')?.addEventListener('click', async () => {
    const name = document.getElementById('new-film').value.trim();
    const categoryId = parseInt(categorySelect.value);
    if (!name || !categoryId) return;
    await supabase.from('films').insert([{ name, category_id: categoryId }]);
    document.getElementById('new-film').value = '';
  });
};
</script>
</body>
</html>
